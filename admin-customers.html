<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Customers - S Shop LK</title>
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="https://i.ibb.co/FqsbsjVB/S-shop-lk-logo.png">
    <link rel="shortcut icon" type="image/png" href="https://i.ibb.co/FqsbsjVB/S-shop-lk-logo.png">
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&display=swap');
        body {
            font-family: 'Space Grotesk', sans-serif;
            background-color: #f8fafc;
            color: #334155;
        }
        
        .customer-card {
            transition: all 0.3s ease;
        }
        
        .customer-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
        }
        
        .status-active { background-color: #d1fae5; color: #065f46; }
        .status-inactive { background-color: #fee2e2; color: #991b1b; }
        .status-vip { background-color: #fef3c7; color: #92400e; }
    </style>
</head>
<body class="min-h-screen">

    <!-- Header -->
    <header class="bg-white shadow-sm border-b border-gray-200">
        <div class="container mx-auto px-4 py-4 flex justify-between items-center">
            <div class="flex items-center space-x-2">
                <svg class="h-8 w-8 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"></path>
                </svg>
                <span class="text-2xl font-extrabold text-gray-900">Customers Management</span>
            </div>
            <div class="flex items-center space-x-4">
                <span class="text-sm text-gray-600">Welcome, <span id="adminUsername">Admin</span></span>
                <button onclick="logout()" class="bg-red-600 text-white px-4 py-2 rounded-lg font-semibold hover:bg-red-700 transition-colors">
                    Logout
                </button>
                <a href="index.html" class="text-blue-600 hover:text-blue-800">‚Üê Back to Website</a>
            </div>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="bg-white shadow-sm border-b border-gray-200">
        <div class="container mx-auto px-4">
            <div class="flex space-x-8 py-2">
                <a href="admin-dashboard.html" class="text-gray-500 hover:text-gray-700 py-2 px-1 text-sm font-medium">
                    Dashboard
                </a>
                <a href="admin.html" class="text-gray-500 hover:text-gray-700 py-2 px-1 text-sm font-medium">
                    Products
                </a>
                <a href="admin-orders.html" class="text-gray-500 hover:text-gray-700 py-2 px-1 text-sm font-medium">
                    Orders
                </a>
                <a href="admin-customers.html" class="text-blue-600 border-b-2 border-blue-600 py-2 px-1 text-sm font-medium">
                    Customers
                </a>
                <a href="admin-chat.html" class="text-gray-500 hover:text-gray-700 py-2 px-1 text-sm font-medium">
                    Chat
                </a>
                <a href="admin-logs.html" class="text-gray-500 hover:text-gray-700 py-2 px-1 text-sm font-medium">
                    Logs
                </a>
                <a href="admin-settings.html" class="text-gray-500 hover:text-gray-700 py-2 px-1 text-sm font-medium">
                    Settings
                </a>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8">
        
        <!-- Stats Overview -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
            <div class="bg-white p-6 rounded-xl border border-gray-200">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-gray-600 text-sm font-medium">Total Customers</p>
                        <p class="text-3xl font-bold text-gray-900" id="totalCustomers">0</p>
                    </div>
                    <div class="p-3 bg-blue-100 rounded-full">
                        <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"></path>
                        </svg>
                    </div>
                </div>
            </div>

            <div class="bg-white p-6 rounded-xl border border-gray-200">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-gray-600 text-sm font-medium">Active Customers</p>
                        <p class="text-3xl font-bold text-green-600" id="activeCustomers">0</p>
                    </div>
                    <div class="p-3 bg-green-100 rounded-full">
                        <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                    </div>
                </div>
            </div>

            <div class="bg-white p-6 rounded-xl border border-gray-200">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-gray-600 text-sm font-medium">VIP Customers</p>
                        <p class="text-3xl font-bold text-yellow-600" id="vipCustomers">0</p>
                    </div>
                    <div class="p-3 bg-yellow-100 rounded-full">
                        <svg class="w-6 h-6 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"></path>
                        </svg>
                    </div>
                </div>
            </div>

            <div class="bg-white p-6 rounded-xl border border-gray-200">
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-gray-600 text-sm font-medium">New This Month</p>
                        <p class="text-3xl font-bold text-purple-600" id="newCustomers">0</p>
                    </div>
                    <div class="p-3 bg-purple-100 rounded-full">
                        <svg class="w-6 h-6 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"></path>
                        </svg>
                    </div>
                </div>
            </div>
        </div>

        <!-- Filters and Actions -->
        <div class="bg-white rounded-xl border border-gray-200 p-6 mb-6">
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center space-y-4 md:space-y-0">
                <div class="flex flex-col md:flex-row space-y-2 md:space-y-0 md:space-x-4">
                    <select id="statusFilter" class="px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="">All Status</option>
                        <option value="active">Active</option>
                        <option value="inactive">Inactive</option>
                        <option value="vip">VIP</option>
                    </select>
                    
                    <input type="text" id="searchCustomers" placeholder="Search customers..." class="px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    
                    <select id="sortFilter" class="px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="name">Sort by Name</option>
                        <option value="email">Sort by Email</option>
                        <option value="joinDate">Sort by Join Date</option>
                        <option value="totalOrders">Sort by Orders</option>
                    </select>
                </div>
                
                <div class="flex space-x-2">
                    <button onclick="addSampleCustomer()" class="bg-blue-600 text-white px-4 py-2 rounded-lg font-semibold hover:bg-blue-700 transition-colors">
                        Add Sample Customer
                    </button>
                    <button onclick="exportCustomers()" class="bg-green-600 text-white px-4 py-2 rounded-lg font-semibold hover:bg-green-700 transition-colors">
                        Export CSV
                    </button>
                </div>
            </div>
        </div>

        <!-- Customers List -->
        <div class="bg-white rounded-xl border border-gray-200 p-6">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-gray-900">Customers</h2>
                <div class="text-sm text-gray-600">
                    Showing <span id="showingCount">0</span> of <span id="totalCount">0</span> customers
                </div>
            </div>
            
            <div id="customersList" class="space-y-4">
                <!-- Customers will be loaded here -->
            </div>
            
            <!-- No Customers Message -->
            <div id="noCustomersMessage" class="text-center py-12 hidden">
                <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197m13.5-9a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0z"></path>
                </svg>
                <h3 class="mt-2 text-sm font-medium text-gray-900">No customers found</h3>
                <p class="mt-1 text-sm text-gray-500">Get started by adding your first customer.</p>
                <div class="mt-6">
                    <button onclick="addSampleCustomer()" class="inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700">
                        Add Sample Customer
                    </button>
                </div>
            </div>
        </div>
    </main>

    <!-- Customer Details Modal -->
    <div id="customerModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full hidden z-50">
        <div class="relative top-20 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-1/2 shadow-lg rounded-md bg-white">
            <div class="mt-3">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-lg font-medium text-gray-900">Customer Details</h3>
                    <button onclick="closeCustomerModal()" class="text-gray-400 hover:text-gray-600">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
                
                <div id="customerModalContent">
                    <!-- Customer details will be loaded here -->
                </div>
                
                <div class="flex justify-end space-x-3 mt-6">
                    <button onclick="closeCustomerModal()" class="bg-gray-500 text-white px-4 py-2 rounded-lg font-semibold hover:bg-gray-600 transition-colors">
                        Close
                    </button>
                    <button onclick="updateCustomer()" class="bg-blue-600 text-white px-4 py-2 rounded-lg font-semibold hover:bg-blue-700 transition-colors">
                        Update Customer
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="firebase-config.js"></script>

    <script>
        let customers = [];
        let currentCustomerId = null;

        // Check authentication
        window.addEventListener('load', function() {
            const isLoggedIn = sessionStorage.getItem('adminLoggedIn');
            if (isLoggedIn !== 'true') {
                window.location.href = 'admin-login-google.html';
                return;
            }
            
            // Set admin username
            const adminUsername = sessionStorage.getItem('adminUsername') || 'Admin';
            document.getElementById('adminUsername').textContent = adminUsername;
            
            // Initialize customers page
            initializeCustomers();
        });

        async function initializeCustomers() {
            try {
                // Load customers from localStorage
                loadCustomers();
                
                // Set up event listeners
                setupEventListeners();
                
            } catch (error) {
                console.error('Error initializing customers:', error);
            }
        }

        function loadCustomers() {
            try {
                // Load customers from localStorage
                customers = JSON.parse(localStorage.getItem('customers') || '[]');
                
                // If no customers, add some sample customers
                if (customers.length === 0) {
                    addSampleCustomers();
                }
                
                updateCustomersDisplay();
                updateStatistics();
                
            } catch (error) {
                console.error('Error loading customers:', error);
            }
        }

        function addSampleCustomers() {
            const sampleCustomers = [
                {
                    id: 'CUST-001',
                    name: 'John Doe',
                    email: 'john@example.com',
                    phone: '+94 71 123 4567',
                    status: 'active',
                    joinDate: new Date(Date.now() - 30 * 24 * 60 * 60 * 1000).toISOString(),
                    totalOrders: 5,
                    totalSpent: 12500,
                    lastOrder: new Date(Date.now() - 2 * 24 * 60 * 60 * 1000).toISOString(),
                    address: '123 Main St, Colombo, Sri Lanka',
                    notes: 'Regular customer, prefers email delivery'
                },
                {
                    id: 'CUST-002',
                    name: 'Jane Smith',
                    email: 'jane@example.com',
                    phone: '+94 77 987 6543',
                    status: 'vip',
                    joinDate: new Date(Date.now() - 90 * 24 * 60 * 60 * 1000).toISOString(),
                    totalOrders: 15,
                    totalSpent: 45000,
                    lastOrder: new Date(Date.now() - 1 * 24 * 60 * 60 * 1000).toISOString(),
                    address: '456 Oak Ave, Kandy, Sri Lanka',
                    notes: 'VIP customer, high value orders'
                },
                {
                    id: 'CUST-003',
                    name: 'Mike Johnson',
                    email: 'mike@example.com',
                    phone: '+94 76 555 1234',
                    status: 'active',
                    joinDate: new Date(Date.now() - 15 * 24 * 60 * 60 * 1000).toISOString(),
                    totalOrders: 3,
                    totalSpent: 8000,
                    lastOrder: new Date(Date.now() - 5 * 24 * 60 * 60 * 1000).toISOString(),
                    address: '789 Pine Rd, Galle, Sri Lanka',
                    notes: 'New customer, interested in gaming products'
                }
            ];
            
            customers = sampleCustomers;
            localStorage.setItem('customers', JSON.stringify(customers));
        }

        function addSampleCustomer() {
            const newCustomer = {
                id: `CUST-${String(customers.length + 1).padStart(3, '0')}`,
                name: 'New Customer',
                email: 'newcustomer@example.com',
                phone: '+94 70 000 0000',
                status: 'active',
                joinDate: new Date().toISOString(),
                totalOrders: 0,
                totalSpent: 0,
                lastOrder: null,
                address: 'Sample Address',
                notes: 'Sample customer for testing'
            };
            
            customers.unshift(newCustomer);
            localStorage.setItem('customers', JSON.stringify(customers));
            updateCustomersDisplay();
            updateStatistics();
        }

        function updateCustomersDisplay() {
            const customersList = document.getElementById('customersList');
            const noCustomersMessage = document.getElementById('noCustomersMessage');
            
            if (customers.length === 0) {
                customersList.innerHTML = '';
                noCustomersMessage.classList.remove('hidden');
                return;
            }
            
            noCustomersMessage.classList.add('hidden');
            
            const filteredCustomers = filterCustomers();
            
            customersList.innerHTML = filteredCustomers.map(customer => `
                <div class="customer-card bg-white border border-gray-200 rounded-lg p-6 hover:shadow-lg">
                    <div class="flex justify-between items-start">
                        <div class="flex-1">
                            <div class="flex items-center space-x-3 mb-2">
                                <h3 class="text-lg font-semibold text-gray-900">${customer.name}</h3>
                                <span class="px-2 py-1 text-xs font-medium rounded-full status-${customer.status}">
                                    ${customer.status.toUpperCase()}
                                </span>
                            </div>
                            <p class="text-gray-600 mb-1"><strong>Email:</strong> ${customer.email}</p>
                            <p class="text-gray-600 mb-1"><strong>Phone:</strong> ${customer.phone}</p>
                            <p class="text-gray-600 mb-1"><strong>Orders:</strong> ${customer.totalOrders} | <strong>Spent:</strong> LKR ${customer.totalSpent.toLocaleString()}</p>
                            <p class="text-gray-600 mb-1"><strong>Joined:</strong> ${new Date(customer.joinDate).toLocaleDateString()}</p>
                            ${customer.lastOrder ? `<p class="text-gray-600 mb-1"><strong>Last Order:</strong> ${new Date(customer.lastOrder).toLocaleDateString()}</p>` : ''}
                        </div>
                        <div class="flex space-x-2">
                            <button onclick="viewCustomer('${customer.id}')" class="bg-slate-600 text-white px-3 py-1 rounded text-sm hover:bg-slate-700 transition-colors">
                                View
                            </button>
                            <button onclick="editCustomer('${customer.id}')" class="bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700 transition-colors">
                                Edit
                            </button>
                            <button onclick="deleteCustomer('${customer.id}')" class="bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700 transition-colors">
                                Delete
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
            
            document.getElementById('showingCount').textContent = filteredCustomers.length;
            document.getElementById('totalCount').textContent = customers.length;
        }

        function filterCustomers() {
            let filtered = [...customers];
            
            const statusFilter = document.getElementById('statusFilter').value;
            const searchTerm = document.getElementById('searchCustomers').value.toLowerCase();
            const sortFilter = document.getElementById('sortFilter').value;
            
            // Status filter
            if (statusFilter) {
                filtered = filtered.filter(customer => customer.status === statusFilter);
            }
            
            // Search filter
            if (searchTerm) {
                filtered = filtered.filter(customer => 
                    customer.name.toLowerCase().includes(searchTerm) ||
                    customer.email.toLowerCase().includes(searchTerm) ||
                    customer.phone.includes(searchTerm) ||
                    customer.id.toLowerCase().includes(searchTerm)
                );
            }
            
            // Sort filter
            switch (sortFilter) {
                case 'name':
                    filtered.sort((a, b) => a.name.localeCompare(b.name));
                    break;
                case 'email':
                    filtered.sort((a, b) => a.email.localeCompare(b.email));
                    break;
                case 'joinDate':
                    filtered.sort((a, b) => new Date(b.joinDate) - new Date(a.joinDate));
                    break;
                case 'totalOrders':
                    filtered.sort((a, b) => b.totalOrders - a.totalOrders);
                    break;
            }
            
            return filtered;
        }

        function updateStatistics() {
            const total = customers.length;
            const active = customers.filter(customer => customer.status === 'active').length;
            const vip = customers.filter(customer => customer.status === 'vip').length;
            
            // Count new customers this month
            const now = new Date();
            const monthAgo = new Date(now.getFullYear(), now.getMonth() - 1, now.getDate());
            const newThisMonth = customers.filter(customer => new Date(customer.joinDate) >= monthAgo).length;
            
            document.getElementById('totalCustomers').textContent = total;
            document.getElementById('activeCustomers').textContent = active;
            document.getElementById('vipCustomers').textContent = vip;
            document.getElementById('newCustomers').textContent = newThisMonth;
        }

        function setupEventListeners() {
            document.getElementById('statusFilter').addEventListener('change', updateCustomersDisplay);
            document.getElementById('searchCustomers').addEventListener('input', updateCustomersDisplay);
            document.getElementById('sortFilter').addEventListener('change', updateCustomersDisplay);
        }

        function viewCustomer(customerId) {
            const customer = customers.find(c => c.id === customerId);
            if (!customer) return;
            
            currentCustomerId = customerId;
            
            const modalContent = document.getElementById('customerModalContent');
            modalContent.innerHTML = `
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <h4 class="font-semibold text-gray-900 mb-2">Customer Information</h4>
                        <div class="space-y-2 text-sm">
                            <p><strong>Customer ID:</strong> ${customer.id}</p>
                            <p><strong>Name:</strong> <input type="text" id="customerName" value="${customer.name}" class="w-full px-2 py-1 border rounded"></p>
                            <p><strong>Email:</strong> <input type="email" id="customerEmail" value="${customer.email}" class="w-full px-2 py-1 border rounded"></p>
                            <p><strong>Phone:</strong> <input type="text" id="customerPhone" value="${customer.phone}" class="w-full px-2 py-1 border rounded"></p>
                            <p><strong>Status:</strong> 
                                <select id="customerStatus" class="ml-2 px-2 py-1 border rounded">
                                    <option value="active" ${customer.status === 'active' ? 'selected' : ''}>Active</option>
                                    <option value="inactive" ${customer.status === 'inactive' ? 'selected' : ''}>Inactive</option>
                                    <option value="vip" ${customer.status === 'vip' ? 'selected' : ''}>VIP</option>
                                </select>
                            </p>
                            <p><strong>Join Date:</strong> ${new Date(customer.joinDate).toLocaleDateString()}</p>
                        </div>
                    </div>
                    <div>
                        <h4 class="font-semibold text-gray-900 mb-2">Order Statistics</h4>
                        <div class="space-y-2 text-sm">
                            <p><strong>Total Orders:</strong> <input type="number" id="customerTotalOrders" value="${customer.totalOrders}" class="w-full px-2 py-1 border rounded"></p>
                            <p><strong>Total Spent:</strong> LKR <input type="number" id="customerTotalSpent" value="${customer.totalSpent}" class="w-full px-2 py-1 border rounded"></p>
                            <p><strong>Last Order:</strong> ${customer.lastOrder ? new Date(customer.lastOrder).toLocaleDateString() : 'No orders yet'}</p>
                        </div>
                        
                        <h4 class="font-semibold text-gray-900 mb-2 mt-4">Address</h4>
                        <textarea id="customerAddress" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" rows="2">${customer.address || ''}</textarea>
                        
                        <h4 class="font-semibold text-gray-900 mb-2 mt-4">Notes</h4>
                        <textarea id="customerNotes" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" rows="3">${customer.notes || ''}</textarea>
                    </div>
                </div>
            `;
            
            document.getElementById('customerModal').classList.remove('hidden');
        }

        function closeCustomerModal() {
            document.getElementById('customerModal').classList.add('hidden');
            currentCustomerId = null;
        }

        function updateCustomer() {
            if (!currentCustomerId) return;
            
            const customer = customers.find(c => c.id === currentCustomerId);
            if (!customer) return;
            
            customer.name = document.getElementById('customerName').value;
            customer.email = document.getElementById('customerEmail').value;
            customer.phone = document.getElementById('customerPhone').value;
            customer.status = document.getElementById('customerStatus').value;
            customer.totalOrders = parseInt(document.getElementById('customerTotalOrders').value) || 0;
            customer.totalSpent = parseInt(document.getElementById('customerTotalSpent').value) || 0;
            customer.address = document.getElementById('customerAddress').value;
            customer.notes = document.getElementById('customerNotes').value;
            
            localStorage.setItem('customers', JSON.stringify(customers));
            updateCustomersDisplay();
            updateStatistics();
            closeCustomerModal();
        }

        function editCustomer(customerId) {
            viewCustomer(customerId);
        }

        function deleteCustomer(customerId) {
            if (confirm('Are you sure you want to delete this customer?')) {
                customers = customers.filter(customer => customer.id !== customerId);
                localStorage.setItem('customers', JSON.stringify(customers));
                updateCustomersDisplay();
                updateStatistics();
            }
        }

        function exportCustomers() {
            const csvContent = "data:text/csv;charset=utf-8," 
                + "Customer ID,Name,Email,Phone,Status,Join Date,Total Orders,Total Spent,Last Order,Address,Notes\n"
                + customers.map(customer => 
                    `${customer.id},"${customer.name}","${customer.email}","${customer.phone}",${customer.status},"${new Date(customer.joinDate).toLocaleDateString()}",${customer.totalOrders},${customer.totalSpent},"${customer.lastOrder ? new Date(customer.lastOrder).toLocaleDateString() : ''}","${customer.address || ''}","${customer.notes || ''}"`
                ).join("\n");
            
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "customers.csv");
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function logout() {
            sessionStorage.clear();
            window.location.href = 'admin-login-google.html';
        }
    </script>

</body>
</html> 